#!/usr/bin/env bash

KEYSTORE=${JBOSS_HOME}/standalone/configuration/jBPMKeystore.jceks
KEYSTORE_PW_OLD=jBPMKeyStorePassword
echo "${KEYSTORE_PW_OLD}" | keytool -delete -alias jBPMAlias -storetype JCEKS -keystore "${KEYSTORE}" -v
echo "${KEYSTORE_PW_OLD}" | keytool -storepasswd -new "${KEYSTORE_PW}" -storetype JCEKS -keystore "${KEYSTORE}" -v

CONFIG_FILE="${JBOSS_HOME}"/standalone/configuration/standalone.xml

sed -i "s;KEYSTORE_PW;${KEYSTORE_PW};g" "${CONFIG_FILE}"
sed -i "s;KIE_SERVER_ID;${KIE_SERVER_ID};g" "${CONFIG_FILE}"
sed -i "s;KIE_SERVER_LOCATION;${KIE_SERVER_LOCATION};g" "${CONFIG_FILE}"
sed -i "s;KIE_SERVER_USER;${KIE_SERVER_USER};g" "${CONFIG_FILE}"
sed -i "s;KIE_SERVER_PASSWORD;${KIE_SERVER_PASSWORD};g" "${CONFIG_FILE}"
sed -i "s;KIE_SERVER_CONTROLLER_USER;${KIE_SERVER_CONTROLLER_USER};g" "${CONFIG_FILE}"
sed -i "s;KIE_SERVER_CONTROLLER_PASSWORD;${KIE_SERVER_CONTROLLER_PASSWORD};g" "${CONFIG_FILE}"
sed -i "s;KIE_SERVER_CONTROLLER;${KIE_SERVER_CONTROLLER};g" "${CONFIG_FILE}"

sed -i "s;SMARTCLIDE_KEYCLOAK_REALM;${SMARTCLIDE_KEYCLOAK_REALM};g" "${CONFIG_FILE}"
sed -i "s;SMARTCLIDE_KEYCLOAK_AUTH_SERVER;${SMARTCLIDE_KEYCLOAK_AUTH_SERVER};g" "${CONFIG_FILE}"
sed -i "s;SMARTCLIDE_KEYCLOAK_SSL_REQUIRED;${SMARTCLIDE_KEYCLOAK_SSL_REQUIRED};g" "${CONFIG_FILE}"
sed -i "s;SMARTCLIDE_KEYCLOAK_RESOURCE_BUSINESS_CENTRAL;${SMARTCLIDE_KEYCLOAK_RESOURCE_BUSINESS_CENTRAL};g" "${CONFIG_FILE}"
sed -i "s;SMARTCLIDE_KEYCLOAK_CREDENTIAL_BUSINESS_CENTRAL;${SMARTCLIDE_KEYCLOAK_CREDENTIAL_BUSINESS_CENTRAL};g" "${CONFIG_FILE}"
sed -i "s;SMARTCLIDE_KEYCLOAK_RESOURCE_KIE_SERVER;${SMARTCLIDE_KEYCLOAK_RESOURCE_KIE_SERVER};g" "${CONFIG_FILE}"
sed -i "s;SMARTCLIDE_KEYCLOAK_CREDENTIAL_KIE_SERVER;${SMARTCLIDE_KEYCLOAK_CREDENTIAL_KIE_SERVER};g" "${CONFIG_FILE}"
